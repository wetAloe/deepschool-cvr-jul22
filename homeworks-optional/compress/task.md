# Уменьшение и ускорение моделей

В этом задании учимся ускорять и уменьшать модельки.

В задании есть три части (дистилляция, прунинг и квантизация). Каждую из трех частей можно делать и сдавать независимо.

### Подготовка

[Скачайте](download.sh) tiny imagenet

Обучите на нем resnet50.

### Дистилляция

Сдистиллируйте resnet50 в MobileNet-V2. Для дистилляции используйте softmax with temperature.
В качестве бейзлайна возьмите значение $t=20$. Если есть время -- попробуйте другие значения параметра.

### Прунинг

Запруньте DWS-блоки в mobilenet'е, оставляя 75% фильтров в каждом блоке.
После прунинга нужно дообучить модель. Для дотюнивания рекомендуем SGD с Cosine Anealing с небольшим lr.


### Квантизация

Полученную модель квантаните средствами torch fx. И дообучите с qat, используя дистилляцию с запруненной mobilenet по l1 или l2.

В конце мы хотим увидеть такую табличку

|description| latency| accuracy|
|:------------- |:---------------:| -------------:|
|resnet50|200ms 1x|98.1 
|mobilenet-v2 distil| 150ms  0.75x| 96.2
|mobilenet-v2 pruning| 120ms  xx| 95.2
|mobilenet-v2 quantization| 60ms  xx| 92.2
|mobilenet-v2 qat| 60ms  xx| 94.2
