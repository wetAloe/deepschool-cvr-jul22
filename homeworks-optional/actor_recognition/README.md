# Определение актёра в кадре

## Подготовка

1. Установка нужных пакетов: `pip install -r requirements.txt`.
2. Скачать модели детекции и распознавания: [link](https://drive.google.com/file/d/18wEUfMNohBJ4K3Ly5wpTejPfDzp-8fI8/view?usp=sharing).
3. Для простоты работы, модели можно разархивировать в папку `models`.
4. Скачать какое-то видео с актёром, [например](https://www.youtube.com/watch?v=-xR_lBtEvSc) в папку `clips`.

## Запуск

В папке с проектом просто запустить `python -m recognition <input_clip_path> <output_clip_path>`.

Для полного списка аргументов можно запустить `python -m recognition --help`.

## Что с этим всем делать?

В проекте главной частью является класс `FaceRecognizer`, который делает векторизацию изображения лица.
Можно изучить разные модели [insightface](https://github.com/deepinsight/insightface/tree/master/model_zoo), и посмотреть на изменение работы.
Можно обучить специальную модель классификации актёров по дескриптору (двух полносвязных слоёв должно хватить) и добавить её в класс.

Для поиска актёра используется функция `config_gallery_finder`, которая возвращает `GalleryFinder`.
В ней можно поиграться с тем, как сравниваются дескрипторы и как ищутся актёры.

Наконец для трекинга лиц используется класс `FaceTracker`, и в него можно добавить аггрегацию дескрипторов с нескольких кадров.
